@page "/programme"
@*context de la base de donné et js runtime*@
@inject PCU001Context _context
@inject IJSRuntime JSRuntime
@* les cdn(s) doivent être ajoutés pour le bon fonctionnement du componant *@

<!-- Section de navigation -->
<div class="row mb-3">
    <div class="col">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <!-- Donne accès au portail selon le role de l'utilisateur -->
                <li class="breadcrumb-item"><a href="/"> Portail </a></li>
                <li style="padding: 0 4px;"><i class="fas fa-home" style="font-size: 15px; color: #3f51b5;"></i></li>
                <li class="breadcrumb-item"><i class="fas fa-circle" style="font-size: 5px; vertical-align: middle; padding-right: 2px;"></i></li>
                <li class="breadcrumb-item active" aria-current="page"> Programmes </li>
            </ol>
        </nav>
    </div>
    <!-- Message distiné pour le groupe d'administration -->
    <div class="col-12">
        <div class="alert alert-light show shadow" role="alert">
            <div class="alert-icon text-warning">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div class="alert-text">
                Veuillez vérifier que tous les plans cadres pour les programmes d'informatique soit à jour pour le 15 novembre.
            </div>
        </div>
    </div>
</div>

<a href="/Programme/420-B0">select</a>

<!-- -->
@if (programmes == null)
{
    <p><em>En cours de chargement...</em></p>
}
else if (!programmes.Any())
{
    <p><em>Nous avons trouvé aucun programme.</em></p>
}
else
{
    <div class="col-12">
        <div class="card shadow">
            <div class="card-header">
                <div class="d-flex">
                    <button class="btn btn-primary"> Ajouter un département </button>
                    <div class="custom-checkbox pl-5 pt-2 disable-select">
                        <input type="checkbox" class="custom-control-input" id="bulkCheckDepart" />
                        <label class="custom-control-label" for="bulkCheckDepart"> Ajouter plus d'un département </label>
                    </div>
                </div>
            </div>
            <!-- Module table des départements -->
            <EjsGrid DataSource="programmes" TValue="Tpgm" AllowPaging="true" Locale="fr-FR" Toolbar="@(new[] { "Add", "Edit", "Delete", "Cancel", "Update" })">
                <GridEditSettings AllowAdding="true" AllowEditing="true" AllowDeleting="true" Mode="EditMode.Dialog"></GridEditSettings>
                <GridColumns>
                    <GridColumn Field=@nameof(Tpgm.PgmTitle) HeaderText="Titre de l'élément" TextAlign="TextAlign.Right" Width="130"></GridColumn>
                    <GridColumn Field=@nameof(Tpgm.PgmDesc) HeaderText="Description" TextAlign="TextAlign.Right" Width="200"></GridColumn>
                </GridColumns>
            </EjsGrid>
        </div>
    </div>
}

@code {

    private List<Tpgm> programmes;

    protected override void OnInitialized()
    {
        // part l'initialisateur chez le client
        JSRuntime.InvokeAsync<string>("modelInitializing");
        programmes = _context.Tpgm.ToList();
    }

    protected override void OnAfterRender(bool firstRender)
    {
        JSRuntime.InvokeAsync<string>("modelLoaded");
    }
}
