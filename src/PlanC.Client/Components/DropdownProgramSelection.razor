@using PlanC.EntityDataModel
@using Syncfusion.EJ2.Blazor
@using Syncfusion.EJ2.Blazor.DropDowns
@*context de la base de donné et js runtime*@
@inject PCU001Context _context
@inject IJSRuntime JSRuntime

<EjsComboBox CssClass="theme-dropdown" TValue="@Programmes" DataSource="programs">
    <ComboBoxEvents TValue="string" ValueChange="OnValueChanged"></ComboBoxEvents>
    <ComboBoxFieldSettings Value="Designation" Text="Designation"></ComboBoxFieldSettings>
</EjsComboBox>

@code {
    private List<Programmes> programs;

    [Parameter]
    public Programmes CurrentSelection { get; set; }

    protected override void OnInitialized()
    {
        programs = _context.Programmes.ToList();
    }

    public event EventHandler<Programmes> ValueChanged;

    public void OnValueChanged(Syncfusion.EJ2.Blazor.DropDowns.ChangeEventArgs<string> val)
    {
        Programmes target = programs.SingleOrDefault(p => p.Designation == val.Value);

        CurrentSelection = target;

        ValueChanged?.Invoke(this, target);
    }
}
